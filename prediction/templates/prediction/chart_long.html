{% extends 'display_part/index.html' %}
{% load static %}
{% block nav %}{% endblock nav %}
{% block content %}

<form class="chart_selector" action="{% url 'prediction:show_chart_long' store_str=store_str %}" method="GET"
    id="submit_form">
    <div class="date_selector">
        <select name="pred_start_date" id="submit_select">
            {% for date in pred_date_list %}
            <option value="{{date}}">{{date}}</option>
            {% endfor %}
        </select>
        <select name="pred_end_date" id="submit_select2">
            {% for date_reversed in pred_date_list_reversed %}
            <option value="{{date_reversed}}">{{date_reversed}}</option>
            {% endfor %}
        </select>
    </div>

    <div class="store_selector">
        <input type="submit" name="store" value="FES">
        <input type="submit" name="store" value="Garage">
        <input type="submit" name="store" value="ç¯ç¯­">
        <input type="submit" name="store" value="ç½ ä¸€ç›®">
        <input type="submit" name="store" value="ç½ ä¸­ç›®é»’">
    </div>
    {% if this_month %}
    <input type="hidden" name="this_month" value={{this_month}}>
    {% endif %}
</form>

<div class="wrap_chart">
    <canvas class="chart_lunch" id='fesLunchChart' height="100"></canvas>
</div>

<div class="df_table_wrapper">
    <div class="df_table_container">
        <table border="3" class="df_table">

            <tr>
                <th class="df_table_index"></th>
                {% for day in dayList %}
                <th class="df_table_column">{{day}}</th>
                {% endfor %}
            </tr>
            {% for index,data in df_forTable_l.iterrows %}
            <tr>
                <td>
                    â˜€{{index}}
                </td>
                {% for d in data %}
                <td>
                    {{d}}å
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
            <tr>
                <td>â˜€å£²ä¸Š</td>
                {% for sales in saleslist_forTable_l %}
                <td>{{sales}}ä¸‡</td>
                {% endfor %}
            </tr>
            <tr>
                <td>â˜€äººæ•°</td>
                {% for p in required_people_l %}
                <td>{{p}}äºº</td>
                {% endfor %}
            </tr>
            <tr>
                <td></td>
                {% comment %} ç©ºç™½ {% endcomment %}
                {% for p in required_people_l %}
                <td></td>
                {% endfor %}
            </tr>
            {% for index,data in df_forTable_d.iterrows %}
            <tr>
                <td>
                    ğŸŒ™{{index}}
                </td>
                {% for d in data %}
                <td>
                    {{d}}å
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
            <tr>
                <td>ğŸŒ™å£²ä¸Š</td>
                {% for sales in saleslist_forTable_d %}
                <td>{{sales}}ä¸‡</td>
                {% endfor %}
            </tr>
            <tr>
                <td>ğŸŒ™äººæ•°</td>
                {% for p in required_people_d %}
                <td>{{p}}äºº</td>
                {% endfor %}
            </tr>
            <tr>
                <td></td>
                {% comment %} ç©ºç™½ {% endcomment %}
                {% for p in required_people_l %}
                <td></td>
                {% endfor %}
            </tr>
            <tr>
                <td>æ—¥ã”ã¨å£²ä¸Š</td>
                {% for p in daily_total_sales_forTable %}
                <td>{{p}}ä¸‡</td>
                {% endfor %}
            </tr>
            <tr>
                <td>ç´¯è¨ˆå£²ä¸Š</td>
                {% for p in amount_sales_forTable %}
                <td>{{p}}ä¸‡</td>
                {% endfor %}
            </tr>

        </table>
        <br>
    </div>
    <span>(éå»2ãƒ¶æœˆå‚ç…§)â˜€å˜ä¾¡{{unit_price_l}}å†† ğŸŒ™å˜ä¾¡{{unit_price_d}}å††</span>
    <span>æ­£ç¢ºç‡ â˜€{{accuracy_l}} ğŸŒ™{{accuracy_d}}</span>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
<script>

document.getElementById('submit_select').value = '{{ start_date }}';
document.getElementById('submit_select2').value = '{{ end_date }}';


    // ãƒ¼ãƒ¼ãƒ¼ãƒ¼æ˜¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    const list = [];
    {% for i in xticks %}
    list.push("{{i}}")
    {% endfor %}

    new Chart(document.getElementById("fesLunchChart"), {
        type: "line",
        data: {
            labels: list,
            datasets: [{
                label: "â˜€äºˆæ¸¬ {{pred_total_l}}å {{total_sales_pred_l}}å††",
                data: {{ pred_l }},
                borderColor: ["rgb(255, 99, 132)"],
                lineTension: 0,
                fill: false,
                // borderWidth:
            },
                {
            label: "ğŸŒ™äºˆæ¸¬ {{pred_total_d}}å {{total_sales_pred_d}}å††  â– ãƒ©ãƒ³ãƒï¼‹ãƒ‡ã‚£ãƒŠãƒ¼åˆè¨ˆ{{total_pred_price}}å††",
            data: {{ pred_d }},
        borderColor: ["rgb(25, 99, 132)"],
        lineTension: 0,
        fill: false,
                    // borderWidth:
                },
            ],
        },
        options: {
        title: {
            display: true,
            text: '{{store_str}}'
        },
        scales: {
            yAxes: [{
                ticks: {
                    min: 0,
                    max: 100,
                    // stepSize: 10,
                },

            }],

            xAxes: [{
                ticks: {
                    autoSkip: false,
                    maxRotation: 70,
                    minRotation: 70,
                }
            }]
        },
        maintainAspectRatio: false


    },
    });


</script>
{% endblock content %}